server {
  listen 443 ssl;
  server_name {{ domain_name }};
  
  ssl_certificate {{ ssl_cert }};
  ssl_certificate_key {{ ssl_key }};

  ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
  ssl_ciphers EECDH+AES128:RSA+AES128:EECDH+AES256:RSA+AES256:EECDH+3DES:RSA+3DES:EECDH+RC4:RSA+RC4:!MD5;
  ssl_prefer_server_ciphers on;

  rewrite (.*) https://www.{{ domain_name }}$1 permanent;
}

server {
  listen 443 ssl;
  server_name www.{{ domain_name }};

  ssl_certificate {{ ssl_cert }};
  ssl_certificate_key {{ ssl_key }};

  ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
  ssl_ciphers EECDH+AES128:RSA+AES128:EECDH+AES256:RSA+AES256:EECDH+3DES:RSA+3DES:EECDH+RC4:RSA+RC4:!MD5;
  ssl_prefer_server_ciphers on;

  location / {
    charset utf-8;
    return 204;
  }
}

server {
  listen 80;
  server_name {{ domain_name }} www.{{ domain_name }};

  rewrite (.*) https://www.{{ domain_name }}$1 permanent;
}
